<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
      "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>Critbit Trees</title><meta content="text/html; charset=utf-8" http-equiv="content-type"></head><body><a href="index.html">[Back to Tcl Stuff]</a><h1>Critbit Trees</h1><p>This module provides the &quot;tree&quot; and &quot;treeset&quot; commands that
implement persistent map and set types for Tcl. Shared trees can be
updated efficiently, unlike dicts--updating a dict with reference
count greater than zero causes its internal structure to be copied.</p><p>As an optimization, inserting into or updating a value in a tree
where all subtrees along the searched path are unshared will alter the
tree in-place without allocating new tree nodes. So for unshared
objects trees should still offer comparable performance to dicts.</p><p>Trees use the same string format as dicts--list of interleaved
key-value pairs--and is meant to provide a COW
(copy-on-write)-friendly replacement. Treesets are written as lists of
values.</p><p>The data structure used is a &quot;critbit&quot; tree. Descriptions can be found <a href="http://cr.yp.to/critbit.html">here</a> and <a href="https://github.com/agl/critbit">here</a> (literate C code in the PDF download).</p><p><span style="font-weight:bold; color:red">[TODO]</span>(all trivial):
locate minimum and maximum elements, find all elements with a given
prefix, implement full dict interface (append, lappend, incr, filter,
etc.), modifying a value via script (c.f, get+replace).</p><h2>Usage</h2><p><table border=0><tr><th colspan=2 style="text-align:left">tree</th></tr><tr><td style="background:#dcdcdc">tree create ?<i>key value</i>...?</td><td>Create a tree.</td></tr><tr><td style="background:#dcdcdc">tree exists <i>treeValue key</i></td><td>Returns 1 if <i>key</i> exists in tree, 0 if it does not.</td></tr><tr><td style="background:#dcdcdc">tree for {<i>keyVar valueVar</i>} <i>treeValue body</i></td><td>Run <i>body</i> once for each mapping pair in the tree, in sorted
      order. Compatible with the yield command.</td></tr><tr><td style="background:#dcdcdc">tree get <i>treeValue key</i></td><td>Return value corresponding to <i>key</i>. Raise an error if no such key exists in the tree.</td></tr><tr><td style="background:#dcdcdc">tree get* <i>treeValue key</i></td><td>If <i>key</i> exists in tree, return a list with a single element containing the
      corresponding value. Otherwise return an empty list.</td></tr><tr><td style="background:#dcdcdc">tree getor <i>treeValue key default</i></td><td>If <i>key</i> exists in tree, return corresponding value. Otherwise return <i>default</i></td></tr><tr><td style="background:#dcdcdc">tree keys <i>treeValue</i></td><td>Return all keys as a sorted list.</td></tr><tr><td style="background:#dcdcdc">tree remove <i>treeValue key</i></td><td>Return a new tree with <i>key</i> removed if it existed in the old tree.</td></tr><tr><td style="background:#dcdcdc">tree replace <i>treeValue key value</i></td><td>Return a new tree with <i>key</i> set to <i>value</i> if it existed.</td></tr><tr><td style="background:#dcdcdc">tree set <i>varName key value</i></td><td>Set value of <i>key</i> to <i>value</i> in the tree stored in variable <i>varName.</i></td></tr><tr><td style="background:#dcdcdc">tree size <i>treeValue</i></td><td>Return size of tree (number of mappings)</td></tr><tr><td style="background:#dcdcdc">tree tolist <i>treeValue</i></td><td>Return a list containing alternating keys and values, in sorted order.</td></tr><tr><td style="background:#dcdcdc">tree unset <i>varName key</i></td><td>Remove <i>key</i> from tree stored in variable <i>varName</i></td></tr><tr><th colspan=2 style="text-align:left">treeset</th></tr><tr><td style="background:#dcdcdc">treeset add <i>set value</i></td><td>Return new set with elements of <i>set</i> plus <i>value.</i></td></tr><tr><td style="background:#dcdcdc">treeset contains <i>set value</i></td><td>Return 1 if <i>set</i> contains <i>value</i>, 0 otherwise.</td></tr><tr><td style="background:#dcdcdc">treeset create ?<i>value</i>...?</td><td>Return new set with elements ?<i>value</i>...?.</td></tr><tr><td style="background:#dcdcdc">treeset for <i>varName body</i></td><td>Run <i>body</i> for each element in set, in sorted order. Compatible with the yield
      command.</td></tr><tr><td style="background:#dcdcdc">treeset remove <i>set value</i></td><td>Return new set with elements of <i>set</i> minus <i>value.</i></td></tr><tr><td style="background:#dcdcdc">treeset set <i>varName value</i></td><td>Add <i>value</i> to set stored in variable <i>varName.</i></td></tr><tr><td style="background:#dcdcdc">treeset size <i>set</i></td><td>Return number of values in <i>set.</i></td></tr><tr><td style="background:#dcdcdc">treeset tolist <i>set</i></td><td>Return list containing all values in <i>set</i>, in sorted order.</td></tr><tr><td style="background:#dcdcdc">treeset unset <i>varName value</i></td><td>Remove <i>value</i> from set stored in variable <i>varName.</i></td></tr></table></p><h2>Download</h2><p>C source: <a href="critbit.c.txt">critbit.c.txt</a>. File contains two public (non-static)
  functions treeCmd and treesetCmd with suitable signatures for Tcl_CreateObjCmd.</p></body></html>